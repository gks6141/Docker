### docker 설치
- brew install cask docker
- brew install kubectl
- brew install minikube


### docker 이미지 
- docker create [image] : 컨테이너 생성
- docker start [container]: 컨테이너 실행(아이디나 name)
- docker run [image]: 컨테이너 생성 및 시작 (이미지가 없다면 자동으로 이미지 다운로드 후 생성)
- docker  -v : 도커 버전 확인
- docker ps: 실행중인 도커 컨테이너 확인
- docker ps -a : 도커 모든 컨테이너 확인
- docker run \
     -i \   호스트의 표준 입력을 컨테이너의 표준 입력을 연결 (interactive)
     -t \    tty를 할당 (-i -t shell을 실행할때 주로 사용)
     -rm \   컨테이너 실행 종료 후 자동 삭제
     -d \   백그라운 모드로 실행
     --name \ 컨테이너 이름 지정
     -p 80:80 \ 호스트 - 컨테이너 간 포트 바인딩
     -v {주소} \ 호스트 - 컨테이너 간 볼륨 바인딩
     {저장소 이름 / 이미지:버전} \ 실행할 이미지
     my-command  컨테이너 내에서 실행할 명령어
- docker inspect {컨테이너 아이디 or name} : 컨테이너 정보확인( 에러발생할때 주로 사용
- docker pause : 컨테이너 일시 중지
- docker unpause : 컨테이너 재개
- docker stop [container] : 컨텡이너 종료 (sigterm 시그널 전달)
- docker kill [container] : 강제 종료
- docker stop $(docker ps -a -q) : 모든 컨테이너 종료
- docker rm [container] : 컨테이너 삭제
- docker rm -f [container] : 컨테이너 강제 종료 후 삭제 (sigkill 시그널 전달)
- docker run --rm : 컨테이너 실행 종료 후 자동 삭제
- docker container prune : 중지된 모든 컨테이너 삭제

###엔트리 포인트
ex) docker run --entrypoint sh ubuntu:focal
ex) docker run --entrypoint echo ubuntu:focal hello world


### docker 작동 확인
- docker run hello-world

### 간단한 wordpress와 mysql 컨테이너 설치
- vi docker-wordpress.yml (sql 컨테이너와 wordpress컨테이너 설치 파일)

docker-wordpress.yml
      version: "3"
      services:
        mysql_database:
          image: mysql:5.7
          environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: wordpress_db
            MYSQL_USER: wordpress_user
            MYSQL_PASSWORD: changeme!
          volumes:
            - ./mysql:/var/lib/mysql

        wordpress:
          depends_on:
            - mysql_database
          image: wordpress:5.8.1
          ports:
            - "8080:80"
          environment:
            WORDPRESS_DB_HOST: mysql_database:3306
            WORDPRESS_DB_USER: wordpress_user
            WORDPRESS_DB_PASSWORD: changeme!
            WORDPRESS_DB_NAME: wordpress_db
          volumes:
            - ./wordpress_html:/var/www/html

- docker compose -f docker-compose-wordpress.yml up (yml 파일 실행하여 docker 컨테이너 설치)
- localhost:8080으로 접속 --> wordpress 설정 

### DOCKER KAFKA 컨테이너 실행
- vi docker-kafka.yml (sql 컨테이너와 wordpress컨테이너 설치 파일)
 
docker-kafka.yml
    version: '3'
    services:
      zookeeper:
        hostname: zookeeper
        image: confluentinc/cp-zookeeper:6.2.0
        environment:
          ZOOKEEPER_SERVER_ID: 1
          ZOOKEEPER_CLIENT_PORT: 12181
          ZOOKEEPER_DATA_DIR: /zookeeper/data
          ZOOKEEPER_SERVERS: zookeeper:22888:23888
        ports:
          - 12181:12181
          - 22888:22888
        volumes:
          - ./zookeeper/data/1:/zookeeper/data

      kafka:
        image: confluentinc/cp-kafka:6.2.0
        hostname: kafka
        depends_on:
          - zookeeper
        environment:
          KAFKA_BROKER_ID: 1
          KAFKA_ZOOKEEPER_CONNECT: zookeeper:12181
          KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:19092
          KAFKA_LOG_DIRS: /kafka
        ports:
          - 19092:19092
        volumes:
          - ./kafka/logs/1:/kafka

- docker compose -f ./docker-compose-confluent-cluster.yml up

### kafka 사이트 들어가서 community에서 사용할 커맨드 설치
- tar -xvf confluent-6.2.1(다운로드 받은 파일을 압축풀기)
- cd confluent-6.2.1
- cd bin
- ./kafka-topics --bootstrap-server localhost:19092 --create --topic cluster --partitions 2 --replication-factor 3 (topic 생성)
### 동작확인
- ./kafka-console-producer --bootstrap-server localhost:19092 --topic cluster (메시지 입력)
- ./kafka-console-consumer --bootstrap-server localhost:19092 --topic cluster (메시지 받기)

-./kafka-topics --describe --bootstrap-server localhost:19092 --topic cluster (topic 확인)
- Isr: 리더와 팔로우의 모음
